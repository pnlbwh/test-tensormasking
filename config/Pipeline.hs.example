import           Development.Shake.Config
import           HCP                      (rules)
import           HCP.PostEddy
import           OutputDirectory          (outdir)
import           Shake.BuildKey
import           Software.UKFTractography (UKFTractographyExe (..), rules)


main :: IO ()
main = shakeArgs shakeOptions{shakeFiles=outdir, shakeVerbosity=Chatty} $ do
  usingConfigFile "config/all.cfg"

  action $ do
    -- Just caseids <- fmap words <$> getConfig "caselist"
    -- apply [HcpDwi caseid | caseid <- caseids] :: Action [[Double]]

    Just ukf_hash <- getConfig "UKFTractography_hash"
    apply1 (UKFTractographyExe ukf_hash) :: Action [Double]

  HCP.rules
  Software.UKFTractography.rules
